========================================================================
==                                                                    ==
==  YU-RIS 台本化ツール「YSDhk」                                      ==
==                                                                    ==
==                                  Copyright (C) 1997-2011 Firstia.  ==
==                                                                    ==
========================================================================

■注意事項------------------------------------------------------------------

YSDhk は、シナリオテキストから台本ファイル(EXCELファイル)を生成し、
同時にボイス命令を埋め込んだスクリプトも自動生成するツールです。
※別途 Microsoft 社の Excel が必要になります。
※台本化には、このツールの他に、Excelマクロを使用します。
  Excelマクロの動作に関しては Excel2000, Excel2003 で確認が取れています。
  それ以降のバージョンなら多分動くとは思いますが、逆にそれ以前のバージョン
  だともしかしたら動かないかもしれません。ご了承ください。


■使い方--------------------------------------------------------------------

※念のため、作業前にシナリオは必ずバックアップを取っておいてください。

※台本化するキャラは、必ずキャラＩＤ３文字（半角大文字３文字）が必要になりますので
  最初に決めておいてください。


①【準備１】最初に

    「_元テキスト」フォルダ内に、シナリオファイルをフォルダごとコピーしてください。
    ※複数階層フォルダ(フォルダの中にフォルダという構造)にも対応しています。

    またファイル数が膨大な場合は、この段階で
    テキスト結合分割ツール「YSTXP.exe」を利用して、テキストをグループ毎に
    １ファイルに結合しておくといいかもしれません。


②【準備２】定義ファイルを記述する

  定義ファイルは「台本定義.txt」と「キャラ定義.txt」の２ファイルになります。

  まず、「台本定義.txt」ファイルを開き、ブランド名とタイトル名を記述してください。

  次に、「キャラ定義.txt」ファイルを開き、キャラ名を定義します。
  書き方は中身を開いてそちらを参考にして下さい。または直接聞いてください。

  セリフのあるキャラ（例えば「男子学生１」など）は全て登録する必要があるので、
  その場合「_補助ツール」フォルダ内にあるキャラ名抽出ツール「YSCNF.exe」を使用して、
  シナリオ中に出てくる名前一覧を抽出しておきます。

  ○「YSCNF.exe」を起動します
      ↓
  ○オプションで名前の最大長を設定します。
      ↓
  ○「_元テキスト」フォルダ内の全フォルダをドラッグします。
      ↓
  ○「全ファイル変換」を選択します。
      ↓
  ○ツールを閉じます。
      ↓
  ○「output.txt」ファイルが生成されており、その中に検出された名前候補が一覧で表示されます。
    ※ただしあくまで候補ですので、ゴミや間違った候補が見つかってしまう場合があります。
      それらは「除外リスト.txt」に登録しておけば、再抽出の際に二度と抽出されないようになります。

  それをもとにキャラ名を登録します。

  サブキャラまで登録する理由：台本化の際にキャラ名としてキャラ欄の位置に正しく表示させるためです。
  ただこれは面倒な作業でもあるので、今後仕様を再検討するかもしれません。



③【変換１】変換する

  ○YSDhk.exe を起動します。
      ↓
  ○[ツール]→[オプション]を開き、ボイス名につける第二文字列を設定します。
    ※ボイス名が重複しないように、例えば台本を出力する日毎にここは変えたりしてください。
    たとえば、一回目の台本だしの時は「01_」 、二回目の時は「02_」とか。
    そうすることで不定回数にわたる台本出しの際にも、ボイスが重複せずに済みます。
    ただあまり長すぎると台本に印刷する際にボイス名が小さくなってしまう恐れがあります。
    無記入の場合は xxx_0001 という形になります。
      ↓
  ○「_元テキスト」フォルダの中の全ファイルをドラッグします。
    ※「_元テキスト」フォルダ自体はドラッグしないでください。
      いちおう正しく出力はされますが、出力されるフォルダ構成に「_元テキスト」という
      フォルダが含まれてしまい、ちょっと鬱陶しいです。
      ↓
  ○「全ファイル変換」を選択します。
    各種データが生成開始されます。
      ↓
  ○ツールを閉じます。
      ↓
  ○・「ボイス命令埋込済テキスト」
    ・「スタッフ用ボイスリスト」
    ・「声優用台本」

    の３つのフォルダが生成されています。が、

    ・「声優用台本」

    に関してはまだ完成しておらず、
    EXCELマクロを使ってもう一回変換しなくてはならない作業があります。
    以下の手順になります。



④【変換２】台本EXCELファイルを作成する

  ○「YSDhk.xls」ファイルを開きます。
        ↓
  ○「マクロがあります」という旨の警告が表示される場合は
    「マクロを有効にする」を選択してください。
        ↓
  ○次に「Ctrl+F」キーを押すと、開始確認ダイアログが表示され、
    「はい」を押すと声優用台本の変換作業が開始されます。
    ※テキストの量やマシン速度によっては、数分、長くて数十分程度の時間が
      かかる場合があります。ご注意ください。
        ↓
  ○「台本化処理が完了しました」と表示されたら終了です。
    「YSDhk.xls」ファイルを閉じてください。
        ↓
  ○声優用台本フォルダ内の xls ファイルを開いてみて、
    正しく台本化できているのを確認したら、そのままA4用紙に印刷します。


