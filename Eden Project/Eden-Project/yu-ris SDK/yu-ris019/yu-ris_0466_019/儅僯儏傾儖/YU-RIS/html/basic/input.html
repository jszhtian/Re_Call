<HTML><HEAD><TITLE>YU-RIS マニュアル</TITLE><LINK REL=STYLESHEET TYPE="text/css" HREF="../css/ysstyle.css"></HEAD>
<BODY STYLE="margin:0pt 0pt 0pt 0pt" BGCOLOR=#000000>

<TABLE CELLSPACING=0 CELLPADDING=0 HEIGHT=20 CLASS=MAX>
<TR><TD BGCOLOR=#303060 CLASS=t30>
<B CLASS=t30>■<A HREF="../top.html">TOP</A>＞<A HREF="./top.html">概要</A>＞入力</B>
</TD></TR></TABLE>

<TABLE CELLSPACING=0 CELLPADDING=0 HEIGHT=40 CLASS=MAX>
<TR><TD BGCOLOR=#606080 CLASS=t20>
　<A HREF="./basic.html">[基本文法]</A>
　<A HREF="./variable.html">[変数]</A>
　<A HREF="./svariable.html">[システム変数]</A>
　<A HREF="./macro.html">[マクロ]</A>
　<A HREF="./layer.html">[ＣＧレイヤ]</A>
　<A HREF="./task.html">[タスク]</A>
　<A HREF="./input.html">[入力]</A>
</TD></TR></TABLE>

<PRE>
<FONT CLASS=t70>■入力</FONT>
<FONT CLASS=t20>
システム変数を使って、現在どのキー／マウスボタン／ゲームパッドボタンが押されているかを
調べることが出来ます。

例えば「Ａ」キーが押されている間、それに対応するシステム変数 @_KEY_A の値が
押された瞬間から
<FONT CLASS=t40>
	1 → 2 → 3 → 4 → 5 → 6 → ...
</FONT>
と１フレーム毎に変化していきます。

「Ａ」キーが離された場合（押されていない場合）、今度は @_KEY_A の値は
離された瞬間から
<FONT CLASS=t40>
	-1 → -2 → -3 → -4 → -5 → -6 → ...
</FONT>
と１フレーム毎に変化していきます。

このことを利用して、IF 文などを使ってキー／マウス／パッド入力処理をおこなうことが出来ます。

いろいろ例を挙げてみます。


-----------------------------------------------------------------------
例１

LOOP[]
	IF[@_KEY_Z==1]
		//〜何らかの処理Ａ〜
	IFEND[]
	WAIT[FRAME=1]
LOOPEND[]

「Ｚ」キーが押された瞬間、１回だけ処理Ａが実行されることになります。


-----------------------------------------------------------------------
例２

LOOP[]
	IF[@_KEY_Z>0]
		//〜何らかの処理Ａ〜
	IFEND[]
	WAIT[FRAME=1]
LOOPEND[]

@_KEY_Z の値が０より大きいなら式が「真」になるため、この場合
「Ｚ」キーが押されているあいだ毎回処理Ａが実行されます。


-----------------------------------------------------------------------
例３

LOOP[]
	IF[@_KEY_Z>=60]
		//〜何らかの処理Ａ〜
	IFEND[]
	WAIT[FRAME=1]
LOOPEND[]

「Ｚ」キーを60フレーム分(FPS60設定で１秒)押し続けたら、処理Ａが実行されます。


-----------------------------------------------------------------------
例４

INT[@SP_Z=5] // ←２以上の値を入れてください

LOOP[]
	IF[@_KEY_Z>0 && (@_KEY_Z+@SP_Z-1)%@SP_Z==0]
		//〜何らかの処理Ａ〜
	IFEND[]
	WAIT[FRAME=1]
LOOPEND[]

こんな書き方をすると、５フレームに１回、処理Ａが実行されるようになります。
シューティングの連射設定などにも使えるかと思います。


-----------------------------------------------------------------------
例５

LOOP[]
	IF[@_KEY_Z<0]
		//〜何らかの処理Ａ〜
	IFEND[]
	WAIT[FRAME=1]
LOOPEND[]

「Ｚ」キーが押されていなければ、処理Ａが実行されます。


-----------------------------------------------------------------------
例６

LOOP[]
	IF[@_KEY_Z==-30]
		//〜何らかの処理Ａ〜
	IFEND[]
	WAIT[FRAME=1]
LOOPEND[]

「Ｚ」キーが30フレーム分(FPS60設定で0.5秒)押されなかった場合、処理Ａが実行されます。



<FONT CLASS=t70>■オーバーフロー問題と、安全性の保証</FONT>

常に値が変化していくということは、いずれオーバーフロー(桁あふれ)を起こし、
誤作動するかもしれない問題を孕んでいます。

例えばボタンが何も押されていない状態でも勝手に -1 ずつカウントされていくため、
いずれはオーバーフローを起こし、マイナスが逆にプラス(＋)の値になってしまい、
それが原因で『ボタンが押されたものと間違って動作してしまう』事が考えられます。

これは、かなり致命的な不都合のように考えられますが、結論から言ってしまえば
『全く問題にならない』と言うことが出来ます。

なぜなら、そのオーバーフローするまでの時間が半端ではありません。

具体的にどのくらいかと言うと、YU-RISの取り扱う変数は64bit変数であることから、
システム変数の値が -9223372036854775808 という値より小さくなったときに、
オーバーフローすることになります。
仮にFPS60設定の場合、１秒間で -60 カウントされますから、
-9223372036854775808 の値に達するまでの時間を計算すると、

	-9223372036854775808 ÷ ( -60 ×60秒×60分×24時間×365日)

	＝ 4874520144 年 (約４９億年)

と、これだけかかります（＾＾；
仮に最高のFPS256設定だとしても 1142465658 年（約１１億年）になります。
とりあえず人類が存在しているうちはオーバーフローすることはないです（＾＾；


このことから、
『値は変化し続けるがオーバーフローは起こさない』と保証することが出来ます。

</PRE>
<BR></FONT></B>
<BR></FONT>


</BODY></HTML>
